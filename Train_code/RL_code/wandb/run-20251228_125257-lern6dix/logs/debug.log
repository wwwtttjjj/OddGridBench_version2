2025-12-28 12:52:57,110 INFO    MainThread:4024 [wandb_setup.py:_flush():81] Current SDK version is 0.22.2
2025-12-28 12:52:57,110 INFO    MainThread:4024 [wandb_setup.py:_flush():81] Configure stats pid to 4024
2025-12-28 12:52:57,111 INFO    MainThread:4024 [wandb_setup.py:_flush():81] Loading settings from /root/.config/wandb/settings
2025-12-28 12:52:57,111 INFO    MainThread:4024 [wandb_setup.py:_flush():81] Loading settings from /jiangwenhao/wengtengjin/oddgrid_task/OddGridBench_clean/Train_code/RL_code/wandb/settings
2025-12-28 12:52:57,111 INFO    MainThread:4024 [wandb_setup.py:_flush():81] Loading settings from environment variables
2025-12-28 12:52:57,111 INFO    MainThread:4024 [wandb_init.py:setup_run_log_directory():705] Logging user logs to /jiangwenhao/wengtengjin/oddgrid_task/OddGridBench_clean/Train_code/RL_code/wandb/run-20251228_125257-lern6dix/logs/debug.log
2025-12-28 12:52:57,111 INFO    MainThread:4024 [wandb_init.py:setup_run_log_directory():706] Logging internal logs to /jiangwenhao/wengtengjin/oddgrid_task/OddGridBench_clean/Train_code/RL_code/wandb/run-20251228_125257-lern6dix/logs/debug-internal.log
2025-12-28 12:52:57,111 INFO    MainThread:4024 [wandb_init.py:init():832] calling init triggers
2025-12-28 12:52:57,111 INFO    MainThread:4024 [wandb_init.py:init():837] wandb.init called with sweep_config: {}
config: {'data': {'train_files': '/jiangwenhao/wengtengjin/oddgrid_task/OddGridBench_clean/SOI_type/train/train_rl_data.jsonl', 'val_files': '/jiangwenhao/wengtengjin/oddgrid_task/OddGridBench_clean/SOI_type/train/test_rl_data.jsonl', 'prompt_key': 'problem', 'answer_key': 'answer', 'image_key': 'images', 'video_key': 'videos', 'image_dir': None, 'video_fps': 2.0, 'max_prompt_length': 2048, 'max_response_length': 1024, 'rollout_batch_size': 512, 'mini_rollout_batch_size': None, 'val_batch_size': 1024, 'format_prompt': '/jiangwenhao/wengtengjin/oddgrid_task/OddGridBench_clean/Train_code/RL_code/train_configs/format_prompt/oddgrid.jinja', 'override_chat_template': None, 'shuffle': True, 'seed': 1, 'min_pixels': 262144, 'max_pixels': 1048576, 'filter_overlong_prompts': False, 'filter_overlong_prompts_workers': 16}, 'worker': {'hybrid_engine': True, 'actor': {'strategy': 'fsdp', 'global_batch_size': 256, 'micro_batch_size_per_device_for_update': 4, 'micro_batch_size_per_device_for_experience': 2, 'max_grad_norm': 1.0, 'clip_ratio_low': 0.2, 'clip_ratio_high': 0.3, 'clip_ratio_dual': 3.0, 'loss_avg_mode': 'token', 'loss_type': 'default', 'ppo_epochs': 1, 'padding_free': True, 'dynamic_batching': True, 'ulysses_size': 1, 'use_torch_compile': True, 'model': {'model_path': '/jiangwenhao/wengtengjin/oddgrid_task/models/Qwen3-VL-2B-Instruct', 'tokenizer_path': '/jiangwenhao/wengtengjin/oddgrid_task/models/Qwen3-VL-2B-Instruct', 'override_config': {}, 'enable_gradient_checkpointing': True, 'trust_remote_code': False, 'freeze_vision_tower': False}, 'optim': {'lr': 1e-06, 'betas': [0.9, 0.999], 'weight_decay': 0.01, 'strategy': 'adamw', 'lr_warmup_ratio': 0.0, 'lr_warmup_steps': None, 'min_lr_ratio': None, 'warmup_style': 'constant', 'training_steps': 100}, 'fsdp': {'enable_full_shard': False, 'enable_cpu_offload': False, 'enable_rank0_init': True, 'use_orig_params': False, 'torch_dtype': None, 'fsdp_size': -1, 'mp_param_dtype': 'bf16', 'mp_reduce_dtype': 'fp32', 'mp_buffer_dtype': 'fp32'}, 'offload': {'offload_params': False, 'offload_optimizer': False}, 'global_batch_size_per_device': -1, 'disable_kl': False, 'use_kl_loss': True, 'kl_penalty': 'low_var_kl', 'kl_coef': 0.01}, 'critic': {'strategy': 'fsdp', 'global_batch_size': 256, 'micro_batch_size_per_device_for_update': 4, 'micro_batch_size_per_device_for_experience': 16, 'max_grad_norm': 1.0, 'cliprange_value': 0.5, 'loss_avg_mode': 'token', 'ppo_epochs': 1, 'padding_free': False, 'dynamic_batching': True, 'ulysses_size': 1, 'model': {'model_path': None, 'tokenizer_path': None, 'override_config': {}, 'enable_gradient_checkpointing': True, 'trust_remote_code': True, 'freeze_vision_tower': False}, 'optim': {'lr': 1e-06, 'betas': [0.9, 0.999], 'weight_decay': 0.01, 'strategy': 'adamw', 'lr_warmup_ratio': 0.0, 'lr_warmup_steps': None, 'min_lr_ratio': None, 'warmup_style': 'constant', 'training_steps': 100}, 'fsdp': {'enable_full_shard': True, 'enable_cpu_offload': False, 'enable_rank0_init': True, 'use_orig_params': False, 'torch_dtype': None, 'fsdp_size': -1, 'mp_param_dtype': 'bf16', 'mp_reduce_dtype': 'fp32', 'mp_buffer_dtype': 'fp32'}, 'offload': {'offload_params': False, 'offload_optimizer': False}, 'global_batch_size_per_device': -1}, 'ref': {'strategy': 'fsdp', 'fsdp': {'enable_full_shard': True, 'enable_cpu_offload': False, 'enable_rank0_init': True, 'use_orig_params': False, 'torch_dtype': None, 'fsdp_size': -1, 'mp_param_dtype': 'bf16', 'mp_reduce_dtype': 'fp32', 'mp_buffer_dtype': 'fp32'}, 'offload': {'offload_params': False, 'offload_optimizer': False}, 'micro_batch_size_per_device_for_experience': 2, 'padding_free': True, 'dynamic_batching': True, 'ulysses_size': 1, 'use_torch_compile': True}, 'reward': {'reward_type': 'batch', 'reward_function': '/jiangwenhao/wengtengjin/oddgrid_task/OddGridBench_clean/Train_code/RL_code/train_configs/reward_function/math.py', 'reward_function_kwargs': {}, 'skip_special_tokens': True, 'num_cpus': 1, 'reward_function_name': 'compute_score'}, 'rollout': {'name': 'vllm', 'n': 4, 'temperature': 1.0, 'top_p': 1.0, 'top_k': -1, 'seed': 1, 'limit_images': 0, 'dtype': 'bf16', 'gpu_memory_utilization': 0.6, 'ignore_eos': False, 'enforce_eager': False, 'enable_chunked_prefill': False, 'tensor_parallel_size': 1, 'max_model_len': None, 'max_num_batched_tokens': 8192, 'disable_log_stats': True, 'disable_tqdm': False, 'val_override_config': {'temperature': 0.6, 'top_p': 0.95, 'n': 1}, 'prompt_length': 2048, 'response_length': 1024, 'trust_remote_code': False}}, 'algorithm': {'gamma': 1.0, 'lam': 1.0, 'adv_estimator': 'grpo', 'disable_kl': False, 'use_kl_loss': True, 'kl_penalty': 'low_var_kl', 'kl_coef': 0.01, 'kl_type': 'fixed', 'kl_horizon': 10000.0, 'kl_target': 0.1, 'online_filtering': False, 'filter_key': 'overall', 'filter_low': 0.01, 'filter_high': 0.99}, 'trainer': {'total_epochs': 2, 'max_steps': 100, 'project_name': 'Anomaly detection', 'experiment_name': '_test', 'logger': ['file', 'wandb'], 'nnodes': 1, 'n_gpus_per_node': 4, 'max_try_make_batch': 20, 'critic_warmup': 0, 'val_freq': 10, 'val_before_train': True, 'val_only': False, 'val_generations_to_log': 3, 'save_freq': 10, 'save_limit': 4, 'save_model_only': False, 'save_checkpoint_path': '/jiangwenhao/wengtengjin/oddgrid_task/OddGridBench_clean/Train_code/RL_code/checkpoints/Anomaly detection/_test', 'load_checkpoint_path': None, 'ray_timeline': None, 'find_last_checkpoint': True}, '_wandb': {}}
2025-12-28 12:52:57,111 INFO    MainThread:4024 [wandb_init.py:init():880] starting backend
2025-12-28 12:52:57,336 INFO    MainThread:4024 [wandb_init.py:init():883] sending inform_init request
2025-12-28 12:52:57,346 INFO    MainThread:4024 [wandb_init.py:init():891] backend started and connected
2025-12-28 12:52:57,352 INFO    MainThread:4024 [wandb_init.py:init():961] updated telemetry
2025-12-28 12:52:57,393 INFO    MainThread:4024 [wandb_init.py:init():985] communicating run to backend with 90.0 second timeout
2025-12-28 12:52:58,336 INFO    MainThread:4024 [wandb_init.py:init():1036] starting run threads in backend
2025-12-28 12:52:59,063 INFO    MainThread:4024 [wandb_run.py:_console_start():2509] atexit reg
2025-12-28 12:52:59,063 INFO    MainThread:4024 [wandb_run.py:_redirect():2357] redirect: wrap_raw
2025-12-28 12:52:59,064 INFO    MainThread:4024 [wandb_run.py:_redirect():2426] Wrapping output streams.
2025-12-28 12:52:59,064 INFO    MainThread:4024 [wandb_run.py:_redirect():2449] Redirects installed.
2025-12-28 12:52:59,074 INFO    MainThread:4024 [wandb_init.py:init():1076] run started, returning control to user process
